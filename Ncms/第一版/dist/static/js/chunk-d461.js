(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d461"],{"12BC":function(e,t,a){},KFUs:function(e,t,a){"use strict";a.r(t);var s={data:function(){return{list:null,listLoading:!0,subMLoading:!0,subject:"",userData:[],contentName:"",showMessage:"",postArgument:"",others:"",indexType:"",subflag:!1,pageData:{page:1,total:100,size:30},addSub:{type:"",name:""},models:[{id:1,name:"精品课"},{id:2,name:"专栏"},{id:3,name:"小课"},{id:4,name:"快听"},{id:5,name:"杂志"},{id:6,name:"快听合辑"},{id:7,name:"合辑"},{id:8,name:"听书"},{id:9,name:"大咖说"},{id:10,name:"听周刊"},{id:11,name:"文章"},{id:12,name:"听外刊"},{id:13,name:"专题列表"},{id:14,name:"中部广告"},{id:15,name:"免费专区"},{id:16,name:"主题书单"},{id:17,name:"vip会员权益图片"},{id:18,name:"首页底部文章"}]}},created:function(){void 0!=this.$route.query.modelId&&this.subjectModelData();var e=this;document.onkeydown=function(t){27==window.event.keyCode&&(e.subflag=!1)}},methods:{subjectModelData:function(){var e=this;this.contentName=this.$route.query.modelName,this.$route.query.modelId&&this.$http.get("api/portal/theme/"+this.$route.query.modelId,{params:{id:this.$route.query.modelId,pgNo:this.pageData.page,rowNum:30}}).then(function(t){t.data.model.list instanceof Array&&(e.subMLoading=!1,e.pageData={page:t.data.model.currPage,size:30,total:t.data.model.totalRowCount},e.userData=t.data.model.list)}),this.listLoading=!0},searchManagement:function(){this.subjectModelData()},golumpData:function(e){this.$router.push({path:"/administer/subject/lump",query:{modelId:this.$route.query.modelId,modelName:this.$route.query.modelName,modeltype:e.themeModel.type,contentId:e.themeModel.id}})},sortChange:function(e){this.showMessage="是否改变内容的排序?",this.postArgument="api/portal/theme/"+this.$route.query.modelId+"/model",this.others={id:e.themeModel.id,sort:Number(e.themeModel.sort)},this.packagingModel(this.showMessage,this.postArgument,this.others)},changeState:function(e){var t=this;this.$http.get("api/portal/theme/"+this.$route.query.modelId+"/"+e.themeModel.id+"/content").then(function(a){a.data.model.list.length>0?(t.showMessage="是否改变"+e.themeModel.name+"的上下架状态?",t.postArgument="api/portal/theme/"+t.$route.query.modelId+"/model",t.others={id:e.themeModel.id,shelvesState:2==e.themeModel.shelvesState?1:2},t.packagingModel(t.showMessage,t.postArgument,t.others)):t.$confirm("模块下没有内容，不能上下架","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){t.$message({type:"info",message:"取消更改"})}).catch(function(){t.$message({type:"info",message:"取消更改"})})})},packagingModel:function(e,t,a){var s=this;this.$confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then(function(){s.$http.put(t,a).then(function(e){!0===e.data.success&&(s.$message({type:"success",message:"成功!"}),s.subjectModelData())})}).catch(function(){s.$message({type:"info",message:"取消"})})},delSubModel:function(e){var t=this;this.$http.get("api/portal/theme/"+this.$route.query.modelId+"/"+e.themeModel.id+"/content").then(function(a){a.data.model.list<1?t.$confirm("是否删除这个专题模块?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.delete("api/portal/theme/deleteThemeModle/"+e.themeModel.id).then(function(e){t.$message({type:"success",message:"成功!"})})}).catch(function(){t.$message({type:"info",message:"取消"})}):t.$message({type:"info",message:"请删除完专题模块下的所有内容"})})},promptb:function(e){var t=this;this.$prompt("改"+e.themeModel.name+"名","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputErrorMessage:"error"}).then(function(a){var s=a.value;t.$http.put("api/portal/theme/"+t.$route.query.modelId+"/model",{id:e.themeModel.id,name:s}).then(function(e){!0===e.data.success&&(t.$message({type:"success",message:"成功!"}),t.subjectModelData())})}).catch(function(){t.$message({type:"info",message:"取消更改"})})},openImg:function(e){},changePage:function(e){this.pageData=e,this.subjectModelData()},createdSubModel:function(){this.subflag=!0},addSubModel:function(){var e=this;""!=this.addSub.name&&""!=this.addSub.type&&this.$http.post("api/portal/theme/ "+this.$route.query.modelId+"/model",this.addSub).then(function(t){!0===t.data.success&&(e.$message({type:"success",message:"成功!"}),e.closesub(),e.subjectModelData())})},closesub:function(){this.subflag=!1},prompsubject:function(){var e=this;this.$prompt("新建模块","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputErrorMessage:"error"}).then(function(t){var a=t.value;e.$http.post("api/portal/theme/ "+e.$route.query.modelId+"/model",{name:a}).then(function(t){!0===t.data.success&&(e.$message({type:"success",message:"成功!"}),e.subjectModelData())})}).catch(function(){e.$message({type:"info",message:"取消更改"})})},gobacksubject:function(){history.go(-1)}}},o=(a("WFyg"),a("KHd+")),n=Object(o.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("router-view"),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:"/administer/subject/model"==e.$route.path,expression:"$route.path =='/administer/subject/model'"}],staticClass:"tableTop",attrs:{type:"flex",gutter:14}},[a("el-col",{staticClass:"management",attrs:{span:14,justify:"space-between"}},[e._v("模块 内容管理: "+e._s(e.contentName))]),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.createdSubModel()}}},[e._v("新建模块")]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.subflag,expression:"subflag"}],staticClass:"submodelstys",staticStyle:{"z-index":"2001"}},[a("div",{staticClass:"submodelsty"}),e._v(" "),a("div",{staticClass:"submodelsub"},[a("span",{staticStyle:{position:"absolute",top:"10px",right:"10px",padding:"4px 15px",cursor:"pointer"},on:{click:e.closesub}},[e._v("Χ")]),e._v(" "),a("el-form",{ref:"form",staticStyle:{"margin-top":"30px"},attrs:{"label-width":"100px"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"模块名"}},[a("el-input",{staticStyle:{width:"160px"},attrs:{size:"small"},model:{value:e.addSub.name,callback:function(t){e.$set(e.addSub,"name",t)},expression:"addSub.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"请选择模块类型",size:"small"},model:{value:e.addSub.type,callback:function(t){e.$set(e.addSub,"type",t)},expression:"addSub.type"}},e._l(e.models,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{staticStyle:{"text-align":"center","margin-right":"100px"}},[a("el-button",{on:{click:e.closesub}},[e._v("取消")]),e._v(" "),a("el-button",{on:{click:e.addSubModel}},[e._v("确定")])],1)],1)],1)])],1)],1),e._v(" "),a("el-row",{attrs:{gutter:12}},[a("el-col",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.subMLoading,expression:"subMLoading"},{name:"show",rawName:"v-show",value:"/administer/subject/model"==e.$route.path,expression:"$route.path =='/administer/subject/model'"}],staticStyle:{width:"100%",height:"100%"},attrs:{data:e.userData,stripe:""}},[a("el-table-column",{attrs:{prop:"id",label:"模块名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{domProps:{textContent:e._s(t.row.themeModel.name)}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"sort",label:"排序",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{staticStyle:{"text-align":"center"},attrs:{size:"small",type:"number"},on:{change:function(a){e.sortChange(t.row)}},model:{value:t.row.themeModel.sort,callback:function(a){e.$set(t.row.themeModel,"sort",a)},expression:"scope.row.themeModel.sort"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"shelvesState",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:1==t.row.themeModel.shelvesState?"blue22":"blue11",domProps:{textContent:e._s(1==t.row.themeModel.shelvesState?"下架":"上架")}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"专题内容管理",width:"380"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",type:"warning"},on:{click:function(a){e.promptb(t.row)}}},[e._v("改名")]),e._v(" "),a("el-button",{attrs:{size:"small",type:1==t.row.themeModel.shelvesState?"success":"info"},domProps:{textContent:e._s(1==t.row.themeModel.shelvesState?"上架":"下架")},on:{click:function(a){e.changeState(t.row)}}}),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){e.golumpData(t.row)}}},[e._v("内容管理")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"danger",disabled:2==t.row.themeModel.shelvesState},on:{click:function(a){e.delSubModel(t.row)}}},[e._v("删除")])]}}])})],1)],1)],1),e._v(" "),a("div",{staticClass:"gobackmodel"},[a("el-button",{staticClass:"gobackmodelbu",attrs:{size:"small"},on:{click:e.gobacksubject}},[e._v("返回")])],1),e._v(" "),"/administer/subject/model"==e.$route.path?a("pagination",{attrs:{pageData:e.pageData},on:{pageChange:e.changePage}}):e._e()],1)},[],!1,null,null,null);n.options.__file="index.vue";t.default=n.exports},WFyg:function(e,t,a){"use strict";var s=a("12BC");a.n(s).a}}]);