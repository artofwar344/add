(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3583"],{SZUT:function(t,e,a){"use strict";var s=a("USsM");a.n(s).a},USsM:function(t,e,a){},dPig:function(t,e,a){"use strict";a.r(e);a("vDqi"),a("MCLT");var s={data:function(){return{list:null,listLoading:!0,subLoading:!0,subject:"",modelStatusval:"",statusVal:"",options:[{value:2,label:"上架"},{value:1,label:"下架"},{value:0,label:"全部"}],pageData:{page:1,total:100,size:30},userData:[]}},created:function(){this.subjectData()},computed:{subjectPath:function(){return"/administer/subject/index"==this.$route.path}},watch:{$route:function(t){this.subjectData()}},methods:{subjectData:function(){var t=this;"/administer/management"==this.$route.path?this.indexType=1:this.indexType=2,this.$http.get("api/portal/theme",{params:{pgNo:this.pageData.page,rowNum:30,name:this.subject,shelvesState:this.statusVal}}).then(function(e){1==e.data.success&&(t.pageData={page:e.data.model.currPage,size:30,total:e.data.model.totalRowCount},t.subLoading=!1,t.userData=e.data.model.list)}),this.listLoading=!0},createModel:function(){this.$router.push({path:"/administer/subject/index/addmodel"})},push:function(){this.$router.push({path:this.$route.path+"/edit"})},search:function(){this.statusVal=Number(this.modelStatusval),this.subjectData()},gomodel:function(t){this.$router.push({path:"/administer/subject/model",query:{modelId:t.theme.id,modelName:t.theme.name}})},delContent:function(t){var e=this;this.$http.get("api/portal/theme/"+t.theme.id).then(function(a){a.data.model.list.length<1?e.$confirm("是否删除这个专题?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.delete("api/portal/theme/"+t.theme.id,{params:{id:t.theme.id}}).then(function(t){e.$message({type:"success",message:"成功!"}),e.subjectData()})}).catch(function(){e.$message({type:"info",message:"取消"})}):(console.log(a.data.model.list.length,"result.data.model.list.length"),e.$message({type:"info",message:"请删除完专题下所有内容"}))})},sortMChange:function(t){this.showMessage="是否改变专题的排序?",this.postArgument="api/portal/theme/"+t.theme.id,this.others={id:t.theme.id,sort:t.theme.sort},this.packagingFn(this.showMessage,this.postArgument,this.others)},changeMstate:function(t){var e=this;this.$http.get("api/portal/theme/"+t.theme.id).then(function(a){a.data.model.list.length>0?(e.showMessage="是否改变专题的上下架状态?",e.postArgument="api/portal/theme/"+t.theme.id,e.others={modelId:t.theme.id,shelvesState:2==t.theme.shelvesState?1:2},e.packagingFn(e.showMessage,e.postArgument,e.others)):e.$confirm("专题下没有模块,不能上下架","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){e.$message({type:"info",message:"取消更改"})}).catch(function(){e.$message({type:"info",message:"取消更改"})})})},packagingFn:function(t,e,a){var s=this;this.$confirm(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then(function(){s.$http.put(e,a).then(function(t){!0===t.data.success&&(s.$message({type:"success",message:"成功!"}),s.subjectData())})}).catch(function(){s.$message({type:"info",message:"取消"})})},gocreatemodel:function(t){t.theme.id?this.$router.push({path:"/administer/subject/index/editmodel",query:{mid:t.theme.id,page:this.pageData.page}}):this.$router.push({path:"/administer/subject/index/editmodel",query:this.$route.query})},prompta:function(t){var e=this;this.$prompt(t.name,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputErrorMessage:"error"}).then(function(a){var s=a.value;e.$http.put("api/portal/theme/"+t.theme.id,{id:t.theme.id,name:s}).then(function(t){!0===t.data.success&&(e.$message({type:"success",message:"成功!"}),e.subjectData())})}).catch(function(){e.$message({type:"info",message:"取消更改"})})},changePage:function(t){this.pageData=t,this.subjectData()}}},n=(a("SZUT"),a("KHd+")),o=Object(n.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("router-view"),t._v(" "),t.subjectPath?a("el-row",{staticClass:"tableTop",attrs:{type:"flex",justify:"end"}},[a("el-col",{staticClass:"subjectcontentText",attrs:{span:2,justify:"space-between"}},[t._v("专题名")]),t._v(" "),a("el-col",{attrs:{span:3}},[a("el-input",{attrs:{size:"small"},model:{value:t.subject,callback:function(e){t.subject=e},expression:"subject"}})],1),t._v(" "),a("el-col",{staticClass:"subjectcontentText",attrs:{span:2,justify:"space-between"}},[t._v("状态")]),t._v(" "),a("el-col",{attrs:{span:3}},[a("el-select",{attrs:{size:"small",placeholder:"全部"},model:{value:t.modelStatusval,callback:function(e){t.modelStatusval=e},expression:"modelStatusval"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:t.search}},[t._v("搜索")])],1),t._v(" "),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.createModel()}}},[t._v("新建专题")])],1)],1):t._e(),t._v(" "),t.subjectPath?a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.subLoading,expression:"subLoading"}],staticStyle:{width:"100%",height:"100%"},attrs:{data:t.userData,stripe:""}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{domProps:{textContent:t._s(e.row.theme.id)}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"theme.name",label:"专题名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"shelvesState",label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:1==e.row.theme.shelvesState?"blue22":"blue11",domProps:{textContent:t._s(1==e.row.theme.shelvesState?"下架":"上架")}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"sort",label:"排序",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticStyle:{"text-align":"center"},attrs:{size:"small",type:"number"},on:{change:function(a){t.sortMChange(e.row)}},model:{value:e.row.theme.sort,callback:function(a){t.$set(e.row.theme,"sort",a)},expression:"scope.row.theme.sort"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"专题管理",width:"380"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small",type:"warning"},on:{click:function(a){t.gocreatemodel(e.row)}}},[t._v(" 编辑")]),t._v(" "),a("el-button",{attrs:{size:"small",type:1==e.row.theme.shelvesState?"success":"info"},domProps:{textContent:t._s(1==e.row.theme.shelvesState?"上架":"下架")},on:{click:function(a){t.changeMstate(e.row)}}}),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){t.gomodel(e.row)}}},[t._v("模块管理")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"danger",disabled:2==e.row.theme.shelvesState},on:{click:function(a){t.delContent(e.row)}}},[t._v("删除")])]}}])})],1):t._e(),t._v(" "),a("div",{staticStyle:{height:"200px",width:"100%"}}),t._v(" "),t.subjectPath?a("pagination",{staticStyle:{position:"absolute",bottom:"0"},attrs:{pageData:t.pageData},on:{pageChange:t.changePage}}):t._e()],1)},[],!1,null,null,null);o.options.__file="index.vue";e.default=o.exports}}]);